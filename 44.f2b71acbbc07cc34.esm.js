"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[44],{hDcW:(e,n,a)=>{a.r(n),a.d(n,{default:()=>q});var t=a("ERkP"),s=a("P0LX"),l=a("/F87"),i=a("RBMA"),r=a("i08G"),o=a("13oN"),d=a("N5nB"),u=a("aGrZ"),c=a("jg1C");function h({onImageChange:e,hasUpload:n=!0,images:a}){const{translate:s}=(0,u.nt)(),l=(0,t.useRef)(null),[i,h]=(0,t.useState)([]);return(0,c.jsxs)(r.rjZ,{container:!0,mt:3,children:[(0,c.jsx)(r.rjZ,{item:!0,xs:4,children:(0,c.jsxs)(r.Kqy,{direction:"row",justifyContent:"space-between",children:[(0,c.jsx)(o.fi,{title:s("insas.photo")}),(0,c.jsx)("input",{type:"file",multiple:!0,onChange:n=>{!function(n){const a=[];for(let e=0;e<n.length;e++)a.push({src:URL.createObjectURL(n[e]),alt:"img1"});h(a),null==e||e(n)}(n.target.files)},style:{display:"none"},ref:l,accept:"image/jpeg, image/png, image/jpg"}),n&&(0,c.jsx)(d.u,{title:s("insas.add_new"),children:(0,c.jsx)(d.zx,{size:"small",onClick:()=>l.current&&l.current.click(),variant:"outlined",children:(0,c.jsx)(d.JO,{src:"add"})})})]})}),(0,c.jsx)(r.rjZ,{item:!0,xs:12,mt:2,children:i.length>0&&(0,c.jsx)(o.ri,{isHorizontal:!0,photos:i})})]})}var f=a("m4FQ"),m=a("uCKF"),x=(a("Ymu0"),a("N8qx"),a("j291")),j=a("hnsu"),p=a("4iGT"),g=a("jO91"),v=a("QSxP"),b=a("45gT");const y={type:b.Z_(),describe:b.Z_()},w=b.Ry().shape({title:b.Z_().required("Title is required"),volume:b.Z_().required("Volume is required"),surface:b.Z_().nullable(),groundLevel:b.Z_().nullable(),sanitizer:b.Z_().nullable(),equipments:b.IX().of(b.Ry().shape(y))});const C=function({onSubmit:e,bodyOfWaterData:n,idbodyofwater:a}){const{translate:s}=(0,u.nt)(),{control:l,watch:i,formState:{errors:h},handleSubmit:f,setValue:m,getValues:x}=(0,j.cI)({resolver:(0,p.X)(w),defaultValues:{title:"",volume:"",surface:"",sanitizer:"",groundLevel:""}}),{fields:b,append:y,remove:C}=(0,j.Dq)({name:"equipments",control:l});return(0,t.useEffect)((()=>{a&&(m("title",(null==n?void 0:n.title)||""),m("volume",(null==n?void 0:n.volume)||""),m("surface",(null==n?void 0:n.surface)||""),m("groundLevel",(null==n?void 0:n.groundLevel)||""),m("sanitizer",(null==n?void 0:n.sanitizer)||""),m("equipments",(null==n?void 0:n.equipments)||[]))}),[m,n,a]),(0,t.useEffect)((()=>{0===b.length&&y({type:"",describe:""})}),[y,b]),(0,c.jsx)("form",{noValidate:!0,onSubmit:f((async n=>{await e(n)})),id:"formBody",children:(0,c.jsxs)(r.rjZ,{container:!0,children:[(0,c.jsx)(r.rjZ,{item:!0,xs:12,md:6,children:(0,c.jsxs)(r.Kqy,{sx:{maxWidth:350},children:[(0,c.jsxs)(r.Kqy,{spacing:2,children:[(0,c.jsx)(o.fi,{title:s("insas.pool_type")}),(0,c.jsx)(j.Qr,{control:l,name:"title",render:({field:{value:e,onChange:n}})=>{var a;return(0,c.jsx)(d.Ph,{value:e,onChange:n,fullWidth:!0,arrValues:v.FP,label:"type",required:!0,error:!!h.title,helperText:null==(a=h.title)?void 0:a.message})}})]}),(0,c.jsxs)(r.Kqy,{spacing:2,sx:{mt:4},children:[(0,c.jsx)(o.fi,{title:s("insas.properties")}),(0,c.jsx)(j.Qr,{name:"volume",control:l,render:({field:{value:e,onChange:n}})=>{var a;return(0,c.jsx)(r.nvn,{label:"Volume",size:"small",value:e,onChange:n,fullWidth:!0,required:!0,error:!!h.volume,helperText:null==(a=h.volume)?void 0:a.message})}}),(0,c.jsx)(j.Qr,{control:l,name:"surface",defaultValue:x().surface,render:({field:{value:e,onChange:n}})=>(0,c.jsx)(d.Ph,{value:e,onChange:n,fullWidth:!0,arrValues:v.Oq,label:"surface"})}),(0,c.jsx)(j.Qr,{control:l,name:"groundLevel",render:({field:{value:e,onChange:n}})=>(0,c.jsx)(d.Ph,{value:e,onChange:n,fullWidth:!0,arrValues:v.GY,label:"ground_level"})}),(0,c.jsx)(j.Qr,{control:l,name:"sanitizer",render:({field:{value:e,onChange:n}})=>(0,c.jsx)(d.Ph,{value:e,onChange:n,fullWidth:!0,arrValues:v.QQ,label:"sanitizer"})})]})]})}),(0,c.jsx)(r.rjZ,{item:!0,xs:12,md:6,children:(0,c.jsxs)(r.Kqy,{sx:{maxWidth:350},children:[(0,c.jsx)(r.xuv,{mb:2,children:(0,c.jsx)(o.fi,{title:s("insas.equipments")})}),(0,c.jsx)(r.rjZ,{container:!0,direction:"column",xs:12,spacing:2,children:(0,c.jsx)(g.Z,{control:l,append:y,fields:b,remove:C,watch:i,errors:h})})]})})]})})};const q=function(){var e,n;const{client:a}=(0,m.CG)((e=>e.client)),{isLoadingPostBodyWater:j,bodyOfWaterData:p}=(0,m.CG)((e=>e.bodyofwater)),{translate:g}=(0,u.nt)(),v=`${null==a||null==(e=a.personalInfo)?void 0:e.firstName} ${null==a||null==(n=a.personalInfo)?void 0:n.lastName}`,[b,y]=(0,t.useState)(!1),w=(0,l.s0)(),{idlocation:q}=(0,l.UO)(),_=(0,m.TL)(),{enqueueSnackbar:Z}=(0,s.Ds)(),{idbodyofwater:O}=(0,l.UO)(),[W,L]=(0,t.useState)();return(0,t.useEffect)((()=>{_((0,f.Ic)(Number(O)))}),[O,_]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(r.rjZ,{container:!0,spacing:2,children:[(0,c.jsx)(r.rjZ,{item:!0,xs:12,children:(0,c.jsxs)(r.Kqy,{spacing:2,children:[(0,c.jsx)(o.aG,{links:[{href:"/dashboard/home",name:"home"},{name:"client_list",href:"/dashboard/clients"},{name:v,noTranslate:!0,href:`/dashboard/clients/${null==a?void 0:a.id}/location/details`},{name:"body_water_other"}]}),(0,c.jsx)(o.Dx,{title:O?null==p?void 0:p.title:g("insas.add_new_body_of_water"),avatar:O&&(null==p?void 0:p.photos[0].url)})]})}),(0,c.jsx)(r.rjZ,{item:!0,xs:12,md:9,children:(0,c.jsxs)(r.Kqy,{spacing:2,children:[(0,c.jsx)(x.m,{children:(0,c.jsx)(C,{onSubmit:O?async function(e){try{const n={data:Object.assign({},e,{photos:W,owner:null==a?void 0:a.id,location:Number(q)}),idbodyofwater:Number(O)};await _((0,f.Ii)(n)).unwrap(),Z("Body Of Water updated successfully!",{variant:"success"}),w(`/dashboard/clients/${null==a?void 0:a.id}/location/details`)}catch(n){Z("Unable to update body of water!",{variant:"error"})}}:async function(e){try{const n=Object.assign({},e,{photos:W,owner:null==a?void 0:a.id,location:Number(q)});await _((0,f.gb)(n)).unwrap(),Z("Body Of Water created successfully!",{variant:"success"}),w(`/dashboard/clients/${null==a?void 0:a.id}/location/details`)}catch(n){Z("Unable to create body of water!",{variant:"error"})}},bodyOfWaterData:p,idbodyofwater:O})}),(0,c.jsx)(d.Zb,{sx:{paddingTop:"10px",pl:"30px",pb:"30px"},children:(0,c.jsx)(h,{onImageChange:function(e){L(e)},hasUpload:!0})})]})})]}),(0,c.jsxs)(r.Kqy,{direction:"row",spacing:2,justifyContent:"end",mt:4,children:[(0,c.jsx)(r.zxk,{sx:{paddingLeft:5,paddingRight:5},onClick:()=>y(!0),children:g("insas.cancel")}),(0,c.jsx)(o.Vq,{type:"discard",message:"Are you sure you want to discard the changes?",isOpen:b,onCancel:()=>y(!1),onClose:()=>{w(`/dashboard/clients/${null==a?void 0:a.id}/location/details`)}}),(0,c.jsx)(i.fl,{type:"submit",variant:"contained",sx:{paddingLeft:5,paddingRight:5},form:"formBody",loading:j,children:g(O?"insas.save":"insas.add_new_body_of_water")})]})]})}}}]);